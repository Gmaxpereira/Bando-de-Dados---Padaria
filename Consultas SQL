-- Uma consulta com junção interna e com a cláusula de seleção where:

SELECT v.data_hora, v.valor_total AS valor_compra, cv.cpf_cliente AS cpf, c.nome
FROM venda v
JOIN cliente_venda cv ON v.cod_venda = cv.cod_venda
JOIN cliente c ON cv.cpf_cliente = c.cpf_cliente
WHERE c.possui_credito = 1; 

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

--Uma consulta com junção externa e com a cláusula de seleção where:

SELECT c.nome AS nome_cliente, e.rua, e.numero, e.bairro, e.cidade
FROM cliente c
LEFT JOIN endereco e ON c.cpf_cliente = e.cpf_cliente;

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Uma consulta com junção interna ou externa, com a cláusula de seleção where, e com uma subconsulta.
SELECT DISTINCT c.nome AS nome_cliente
FROM cliente c
JOIN cliente_venda cv ON c.cpf_cliente = cv.cpf_cliente
JOIN venda v ON cv.cod_venda = v.cod_venda
JOIN fechamento_caixa fc ON v.cod_venda = fc.codigo_venda
WHERE v.data_hora BETWEEN fc.data_fechamento AND fc.data_fechamento + INTERVAL 1 DAY;

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- Uma consulta com junção interna, com a cláusula de seleção where e com a cláusula de agrupamento.
SELECT p.categoria AS categoria_produto, SUM(v.valor_total) AS total_vendas
FROM produto p
JOIN produto_venda pv ON p.cod_produto = pv.cod_produto
JOIN venda v ON pv.cod_venda = v.cod_venda
WHERE v.data_hora BETWEEN '2023-12-06' AND '2023-12-09'
GROUP BY p.categoria;
